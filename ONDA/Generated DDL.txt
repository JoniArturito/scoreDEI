CREATE TABLE user (
	id	 INTEGER,
	name	 VARCHAR(512) NOT NULL,
	email	 VARCHAR(512) UNIQUE NOT NULL,
	phone	 BIGINT UNIQUE NOT NULL,
	password VARCHAR(512) NOT NULL,
	PRIMARY KEY(id)
);

CREATE TABLE regular_user (
	user_id INTEGER,
	PRIMARY KEY(user_id)
);

CREATE TABLE admin (
	user_id INTEGER,
	PRIMARY KEY(user_id)
);

CREATE TABLE team (
	id	 BIGINT,
	name VARCHAR(512) UNIQUE NOT NULL,
	logo BYTEA,
	PRIMARY KEY(id)
);

CREATE TABLE player (
	id	 BIGINT,
	name	 VARCHAR(512) NOT NULL,
	position VARCHAR(512) NOT NULL,
	birthday DATE NOT NULL,
	team_id	 BIGINT NOT NULL,
	PRIMARY KEY(id)
);

CREATE TABLE game (
	id	 BIGINT,
	begindate TIMESTAMP NOT NULL,
	location	 VARCHAR(512) NOT NULL,
	PRIMARY KEY(id)
);

CREATE TABLE event (
	eventdate TIMESTAMP,
	game_id	 BIGINT,
	PRIMARY KEY(eventdate,game_id)
);

CREATE TABLE goal (
	player_id	 BIGINT,
	event_eventdate TIMESTAMP,
	event_game_id	 BIGINT,
	PRIMARY KEY(event_eventdate,event_game_id)
);

CREATE TABLE card (
	yellow		 BOOL NOT NULL DEFAULT True,
	player_id	 BIGINT,
	event_eventdate TIMESTAMP,
	event_game_id	 BIGINT,
	PRIMARY KEY(event_eventdate,event_game_id)
);

CREATE TABLE gamestatus (
	type		 INTEGER,
	event_eventdate TIMESTAMP,
	event_game_id	 BIGINT,
	PRIMARY KEY(event_eventdate,event_game_id)
);

CREATE TABLE team_game (
	team_id BIGINT,
	game_id BIGINT,
	PRIMARY KEY(team_id,game_id)
);

ALTER TABLE regular_user ADD CONSTRAINT regular_user_fk1 FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE admin ADD CONSTRAINT admin_fk1 FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE player ADD CONSTRAINT player_fk1 FOREIGN KEY (team_id) REFERENCES team(id);
ALTER TABLE event ADD CONSTRAINT event_fk1 FOREIGN KEY (game_id) REFERENCES game(id);
ALTER TABLE goal ADD CONSTRAINT goal_fk1 FOREIGN KEY (player_id) REFERENCES player(id);
ALTER TABLE goal ADD CONSTRAINT goal_fk2 FOREIGN KEY (event_eventdate) REFERENCES event(eventdate);
ALTER TABLE goal ADD CONSTRAINT goal_fk3 FOREIGN KEY (event_game_id) REFERENCES event(game_id);
ALTER TABLE card ADD CONSTRAINT card_fk1 FOREIGN KEY (player_id) REFERENCES player(id);
ALTER TABLE card ADD CONSTRAINT card_fk2 FOREIGN KEY (event_eventdate) REFERENCES event(eventdate);
ALTER TABLE card ADD CONSTRAINT card_fk3 FOREIGN KEY (event_game_id) REFERENCES event(game_id);
ALTER TABLE gamestatus ADD CONSTRAINT gamestatus_fk1 FOREIGN KEY (event_eventdate) REFERENCES event(eventdate);
ALTER TABLE gamestatus ADD CONSTRAINT gamestatus_fk2 FOREIGN KEY (event_game_id) REFERENCES event(game_id);
ALTER TABLE team_game ADD CONSTRAINT team_game_fk1 FOREIGN KEY (team_id) REFERENCES team(id);
ALTER TABLE team_game ADD CONSTRAINT team_game_fk2 FOREIGN KEY (game_id) REFERENCES game(id);

